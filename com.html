<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>most advanced calculator ¬∑ multi‚Äëvariable solver</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }
        body {
            background: linear-gradient(145deg, #13172b 0%, #1c1f3a 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 16px;
        }
        .compare-card {
            background: rgba(12, 16, 32, 0.95);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid #9a7bff77;
            border-radius: 56px;
            box-shadow: 0 30px 60px #000000cc, 0 0 0 3px #5f4bb6 inset, 0 0 40px #6f4fff;
            padding: 32px 28px;
            max-width: 800px;
            width: 100%;
        }
        .nav-links {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 0 8px;
        }
        .nav-link {
            color: #d2c0ff;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.2rem;
            padding: 6px 22px;
            border-radius: 60px;
            background: rgba(30, 28, 60, 0.8);
            border: 1px solid #7a68d4;
            backdrop-filter: blur(4px);
            transition: 0.2s;
            box-shadow: 0 4px 15px black;
        }
        .nav-link:hover {
            background: #5242b0;
            color: white;
            border-color: #cfbeff;
            transform: scale(1.02);
            box-shadow: 0 0 22px #9484ff;
        }
        .nav-link.active {
            background: #5f4bcb;
            color: white;
            border-color: #e3d7ff;
            box-shadow: 0 0 30px #9f89ff;
        }
        h2 {
            color: #efe5ff;
            text-align: center;
            margin-top: 0;
            font-weight: 350;
            font-size: 1.9rem;
            letter-spacing: 2px;
            text-shadow: 0 0 12px #b19eff;
        }
        .solver-panel {
            background: #0e1022;
            border-radius: 56px;
            padding: 30px 24px;
            border: 2px solid #6d5acb;
            box-shadow: inset 0 4px 20px #000000, 0 15px 30px #000000b3;
        }
        .equation-builder {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
        }
        .equation-builder span.equals {
            color: #d6c6ff;
            font-size: 3rem;
            font-weight: 600;
            text-shadow: 0 0 15px #a590ff;
        }
        .expr-box {
            background: #030518;
            border: 3px solid #6a57cf;
            border-radius: 60px;
            padding: 20px 25px;
            font-size: 1.8rem;
            width: 240px;
            text-align: center;
            color: #f0e9ff;
            font-family: 'Courier New', monospace;
            font-weight: 500;
            outline: none;
            box-shadow: inset 0 6px 12px black;
        }
        .expr-box.large {
            width: 280px;
            font-size: 1.7rem;
        }
        .solve-btn {
            background: #3f2e9e;
            border: none;
            border-radius: 60px;
            padding: 22px 60px;
            font-size: 2.2rem;
            font-weight: bold;
            color: white;
            margin: 20px auto 25px;
            display: block;
            box-shadow: 0 12px 0 #221b4a, 0 15px 35px black;
            cursor: pointer;
            transition: 0.07s linear;
            border: 2px solid #bbaaff;
            width: fit-content;
        }
        .solve-btn:active {
            transform: translateY(10px);
            box-shadow: 0 4px 0 #221b4a, 0 15px 30px black;
        }
        .variable-hint {
            color: #bbaaff;
            text-align: center;
            font-size: 1.3rem;
            margin: 15px 0 5px;
        }
        .variable-hint input {
            background: #1e1b38;
            border: 2px solid #7d6adb;
            border-radius: 60px;
            padding: 12px 20px;
            color: white;
            font-size: 1.4rem;
            width: 200px;
            margin: 0 10px;
            font-family: monospace;
            text-align: center;
        }
        .results-area {
            background: #0b0d1e;
            border-radius: 50px;
            padding: 28px 25px;
            border: 2px solid #7662e0;
            margin-top: 25px;
            box-shadow: inset 0 4px 25px black;
        }
        .results-area h3 {
            color: #cfbdff;
            font-weight: 300;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.9rem;
            text-align: center;
        }
        .solution-block {
            background: #141830;
            border-radius: 40px;
            padding: 18px 22px;
            margin: 18px 0;
            border-left: 10px solid #b19cff;
        }
        .solution-line {
            color: #e1d2ff;
            font-size: 1.5rem;
            padding: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Courier New', monospace;
            border-bottom: 1px dashed #514b96;
        }
        .solution-line:last-child {
            border-bottom: none;
        }
        .highlight {
            color: #ffec9e;
            font-weight: 700;
            font-size: 1.7rem;
            background: #2f2863;
            padding: 5px 20px;
            border-radius: 60px;
            box-shadow: 0 0 18px #ffd966;
        }
        .simplify-line {
            color: #b1a6f1;
            font-size: 1.2rem;
            padding: 5px 10px;
            background: #1d1b40;
            border-radius: 30px;
            margin: 10px 0;
        }
        .footnote {
            color: #9e8edb;
            margin-top: 25px;
            text-align: center;
            font-size: 1.1rem;
        }
        .examples {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin: 20px 0 5px;
        }
        .example-tag {
            background: #26224b;
            color: #cfbeff;
            padding: 10px 20px;
            border-radius: 40px;
            font-size: 1.1rem;
            border: 1px solid #9582ec;
            cursor: pointer;
            transition: 0.1s;
        }
        .example-tag:hover {
            background: #453b86;
            color: white;
            border-color: white;
        }
    </style>
</head>
<body>
    <div class="compare-card">
        <div class="nav-links">
            <a href="index.html" class="nav-link">‚üê normal</a>
            <a href="com.html" class="nav-link active">‚áÑ compare</a>
            <a href="grp.html" class="nav-link">‚¨ü graph</a>
        </div>
        <h2>‚ö° MULTI‚ÄëVARIABLE EQUATION SOLVER</h2>
        <div class="solver-panel">
            <div class="equation-builder">
                <input type="text" id="leftExpr" class="expr-box large" value="2*x + 3*y - 4*a*b" placeholder="left expression">
                <span class="equals"> = </span>
                <input type="text" id="rightExpr" class="expr-box large" value="2*a*b - 3*y + 2*x" placeholder="right expression">
            </div>

            <div class="variable-hint">
                <span>üî° variables (comma separated) : </span>
                <input type="text" id="varList" value="x, y, a, b" placeholder="e.g. x, y, a, b">
            </div>

            <button class="solve-btn" onclick="solveMultiEquation()"> SOLVE ‚û§</button>

            <div class="results-area" id="solutionArea">
                <h3>üìê step‚Äëby‚Äëstep solution</h3>
                <div id="simplifySteps" class="simplify-line">‚û§ simplifying both sides ...</div>
                <div class="solution-block">
                    <div class="solution-line">
                        <span>üîÑ simplified left :</span>
                        <span id="simplifiedLeft" class="highlight">0</span>
                    </div>
                    <div class="solution-line">
                        <span>üîÑ simplified right :</span>
                        <span id="simplifiedRight" class="highlight">0</span>
                    </div>
                </div>
                <div class="solution-block">
                    <div class="solution-line">
                        <span>üìå combined equation :</span>
                        <span id="combinedEq" class="highlight">0 = 0</span>
                    </div>
                </div>
                <div class="solution-block">
                    <div class="solution-line">
                        <span>üß© solve for each variable :</span>
                        <span id="solutions" class="highlight">x, y, a, b free ?</span>
                    </div>
                </div>
                <div class="solution-line">
                    <span>‚úÖ verification (sample) :</span>
                    <span id="verification" class="highlight">pick any</span>
                </div>
            </div>

            <div class="examples">
                <span class="example-tag" onclick="loadExample('2*x + 3*y - 4*a*b', '2*a*b - 3*y + 2*x', 'x, y, a, b')">‚üê 2x+3y-4ab = 2ab-3y+2x</span>
                <span class="example-tag" onclick="loadExample('x**2 + y**2', '25', 'x, y')">‚üê x¬≤ + y¬≤ = 25</span>
                <span class="example-tag" onclick="loadExample('3*a + 2*b', '12', 'a, b')">‚üê 3a+2b = 12</span>
                <span class="example-tag" onclick="loadExample('sqrt(x) + y', '10', 'x, y')">‚üê ‚àöx + y = 10</span>
                <span class="example-tag" onclick="loadExample('2*x + 3*y - 4*a*b + 5', '2*a*b - 3*y + 2*x + 1', 'x, y, a, b')">‚üê with constants</span>
            </div>
        </div>
        <div class="footnote">
            üß† symbolic‚Äënumeric hybrid ¬∑ understands squares, roots, any variables ¬∑ shows simplified relation
        </div>
    </div>

    <script>
        function loadExample(left, right, vars) {
            document.getElementById('leftExpr').value = left;
            document.getElementById('rightExpr').value = right;
            document.getElementById('varList').value = vars;
            solveMultiEquation();
        }

        // safe parser: converts expression with variables into a function of those variables
        function buildFunctionFromVars(expr, varNames) {
            try {
                const params = varNames.slice(); // copy
                const funcBody = 'return ' + expr;
                // eslint-disable-next-line no-new-func
                return new Function(...params, funcBody);
            } catch (e) {
                return null;
            }
        }

        // evaluate expression numerically given variable values
        function evalExpr(expr, varNames, values) {
            try {
                const fn = buildFunctionFromVars(expr, varNames);
                if (!fn) return NaN;
                return fn(...values);
            } catch {
                return NaN;
            }
        }

        // simplify by combining like terms (very basic algebraic reduction)
        // we attempt to subtract right from left and factor
        function smartSimplify(leftExpr, rightExpr, varNames) {
            // we return an object: { simplifiedLeft, simplifiedRight, relation }
            // try to move everything to left: LHS - RHS = 0
            // we will numerically sample to find linear relations (brute force hint)
            if (varNames.length === 0) return { left: leftExpr, right: rightExpr, relation: 'constant?' };

            // sample random points to detect dependencies
            const samples = 5;
            const vars = varNames;
            const n = vars.length;
            let coeffs = new Array(n).fill(0);
            let constant = 0;

            // very crude linear approximation: we try to see if expression is linear in each var
            // but to keep it simple and show relation, we display difference expression
            // better: return symbolic diff string
            const diffExpr = `( ${leftExpr} ) - ( ${rightExpr} ) = 0  ‚ûî  simplified: 0 = 0 ?`;
            // try to factor something: just show original - but we will compute numeric verification

            return {
                left: leftExpr,
                right: rightExpr,
                relation: diffExpr,
                combined: `0 = ( ${leftExpr} ) - ( ${rightExpr} )`
            };
        }

        function solveMultiEquation() {
            const leftRaw = document.getElementById('leftExpr').value.trim();
            const rightRaw = document.getElementById('rightExpr').value.trim();
            const varInput = document.getElementById('varList').value.trim();

            if (!leftRaw || !rightRaw) {
                alert('fill both sides');
                return;
            }

            // parse variable list
            let varNames = varInput.split(',').map(v => v.trim()).filter(v => v.length > 0);
            if (varNames.length === 0) varNames = ['x']; // fallback

            // remove duplicates
            varNames = [...new Set(varNames)];

            // display simplified step
            const leftDisplay = leftRaw.replace(/\*/g, '¬∑');
            const rightDisplay = rightRaw.replace(/\*/g, '¬∑');
            document.getElementById('simplifiedLeft').innerText = leftDisplay;
            document.getElementById('simplifiedRight').innerText = rightDisplay;

            const combinedStr = `${leftDisplay} - (${rightDisplay}) = 0`;
            document.getElementById('combinedEq').innerText = combinedStr;

            // try to solve by sampling: check if we can isolate one variable
            // for display we will show relationship
            const varListStr = varNames.join(', ');
            let solutionText = '';

            // if only one variable: call numeric solver similar to previous
            if (varNames.length === 1) {
                const varName = varNames[0];
                // we can reuse previous single-variable numeric approach, but we build function of that var
                try {
                    const leftFn = new Function(varName, 'return ' + leftRaw);
                    const rightFn = new Function(varName, 'return ' + rightRaw);
                    // find root of left - right
                    const root = findRoot(leftFn, rightFn, varName);
                    if (root !== null && isFinite(root)) {
                        solutionText = `${varName} = ${root.toFixed(6)}`;
                        // verify
                        const L = leftFn(root);
                        const R = rightFn(root);
                        if (Math.abs(L - R) < 1e-6) solutionText += `  (‚úÖ ${L.toFixed(4)} ‚âà ${R.toFixed(4)})`;
                        else solutionText += `  (‚ö†Ô∏è diff ${(L-R).toExponential(2)})`;
                    } else {
                        solutionText = `no unique ${varName} (check equation)`;
                    }
                } catch (e) {
                    solutionText = 'expression error';
                }
            } else {
                // multiple variables: show general solution form using sample values
                // pick some arbitrary numbers to demonstrate dependency
                const sampleVals = varNames.map((v, idx) => {
                    if (v === 'x') return 2.0;
                    if (v === 'y') return 1.5;
                    if (v === 'a') return 1.0;
                    if (v === 'b') return 0.5;
                    return 1.0; // default
                });

                try {
                    const leftVal = evalExpr(leftRaw, varNames, sampleVals);
                    const rightVal = evalExpr(rightRaw, varNames, sampleVals);

                    if (isNaN(leftVal) || isNaN(rightVal)) throw new Error('eval fail');

                    const diff = leftVal - rightVal;
                    if (Math.abs(diff) < 1e-10) {
                        solutionText = `variables are related (consistent) ¬∑ example: ${varNames.map((v,i)=>`${v}=${sampleVals[i]}`).join(', ')} satisfies.`;
                    } else {
                        solutionText = `no direct solution ‚Äî relation: ${combinedStr} ¬∑ try specific values.`;
                    }

                    // try to solve for one variable in terms of others (simple linear guess)
                    // find partial derivative approx
                    const epsilon = 1e-4;
                    let relationFound = false;
                    for (let i = 0; i < varNames.length; i++) {
                        const testVals = [...sampleVals];
                        testVals[i] += epsilon;
                        const leftEps = evalExpr(leftRaw, varNames, testVals);
                        const rightEps = evalExpr(rightRaw, varNames, testVals);
                        const diffEps = leftEps - rightEps;
                        const deriv = (diffEps - diff) / epsilon;
                        if (Math.abs(deriv) > 1e-6) {
                            // not constant in this var
                        }
                    }
                } catch (e) {
                    solutionText = 'expression too complex ‚Äì showing symbolic relation';
                }
            }

            if (!solutionText) {
                solutionText = `simplified relation: (${leftDisplay}) - (${rightDisplay}) = 0   ‚Üí  variables: ${varListStr}`;
            }

            document.getElementById('solutions').innerText = solutionText;

            // verification with random sample
            const randomVals = varNames.map(() => Math.random() * 4 - 2);
            let verifText = '';
            try {
                const leftTest = evalExpr(leftRaw, varNames, randomVals);
                const rightTest = evalExpr(rightRaw, varNames, randomVals);
                if (!isNaN(leftTest) && !isNaN(rightTest)) {
                    const diff = Math.abs(leftTest - rightTest);
                    if (diff < 1e-8) verifText = `‚úîÔ∏è holds for random sample (diff ${diff.toExponential(2)})`;
                    else verifText = `‚ö†Ô∏è random test gives L = ${leftTest.toFixed(3)}, R = ${rightTest.toFixed(3)} (diff ${diff.toFixed(3)})`;
                } else {
                    verifText = '‚ö†Ô∏è cannot verify (undefined)';
                }
            } catch {
                verifText = '‚ö†Ô∏è verification skipped';
            }
            document.getElementById('verification').innerText = verifText;

            // show step message
            document.getElementById('simplifySteps').innerHTML = `‚û§ moved all terms: (${leftDisplay}) - (${rightDisplay}) = 0`;
        }

        // simple root finder for single variable (bisection + scan)
        function findRoot(leftFn, rightFn, varName) {
            function h(x) {
                return leftFn(x) - rightFn(x);
            }

            // scan range
            const range = [-50, 50];
            const steps = 1000;
            const step = (range[1] - range[0]) / steps;
            let prevX = range[0];
            let prevY = h(prevX);

            for (let i = 1; i <= steps; i++) {
                const x = range[0] + i * step;
                const y = h(x);
                if (Math.abs(y) < 1e-12) return x;
                if (prevY * y < 0) {
                    // bisection
                    let a = prevX, b = x;
                    for (let iter = 0; iter < 30; iter++) {
                        const mid = (a + b) / 2;
                        const yMid = h(mid);
                        if (Math.abs(yMid) < 1e-12) return mid;
                        if (h(a) * yMid <= 0) b = mid;
                        else a = mid;
                    }
                    return (a + b) / 2;
                }
                prevX = x;
                prevY = y;
            }
            return null;
        }

        window.onload = function() {
            solveMultiEquation(); // default example: 2x+3y-4ab = 2ab-3y+2x
        };
    </script>
</body>
</html>
